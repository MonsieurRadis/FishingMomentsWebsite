{{ define "main" }}
{{ if and (.Params.image) (eq .Section "blog") }}
<!-- Blog article layout -->
<article class="blog-article">
  <div class="article-hero" style="background-image: url('{{ .Params.image }}');">
    <div class="article-hero-overlay"></div>
    <div class="container article-hero-content">
      {{/* Breadcrumb */}}
      {{ if .CurrentSection }}
      <div class="breadcrumb">
        {{ $blogHome := .Site.GetPage (printf "/%s/blog" .Language.Lang) }}
        {{ if eq .Language.Lang "en" }}
          {{ $blogHome = .Site.GetPage "/blog" }}
        {{ end }}
        <a href="{{ $blogHome.RelPermalink }}">{{ $blogHome.Title }}</a>
        <span class="breadcrumb-sep">/</span>
        <a href="{{ .CurrentSection.RelPermalink }}">{{ .CurrentSection.Title }}</a>
        <span class="breadcrumb-sep">/</span>
        <span>{{ .Title }}</span>
      </div>
      {{ end }}
      {{ with .Params.tags }}
      <div class="article-tags">
        {{ range . }}<span class="article-tag">{{ . }}</span>{{ end }}
      </div>
      {{ end }}
      <h1>{{ .Title }}</h1>
      <div class="article-meta">
        <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
        <span class="article-reading-time">{{ div (countwords .Content) 200 | add 1 }} min read</span>
      </div>
    </div>
  </div>
  <div class="container article-body">
    {{ .Content }}

    {{/* More in this category */}}
    {{ if .CurrentSection }}
      {{ $currentPage := . }}
      {{ $siblings := where .CurrentSection.Pages "Permalink" "ne" .Permalink }}
      {{ if $siblings }}
      <div class="related-category">
        <h2>More in {{ .CurrentSection.Title }}</h2>
        <div class="related-grid">
          {{ range first 3 $siblings }}
            <a href="{{ .Permalink }}" class="related-card">
              {{ with .Params.image }}
                <div class="related-card-image" style="background-image: url('{{ . }}');"></div>
              {{ end }}
              <span>{{ .Title }}</span>
            </a>
          {{ end }}
        </div>
      </div>
      {{ end }}
    {{ end }}

    <div class="article-cta-box">
      <img src="/images/branding/logo.svg" alt="Fishing Moments" class="article-cta-logo">
      <h3>Put this into practice</h3>
      <p>Fishing Moments gives you species-specific activity forecasts â€” hour by hour, based on real science. Free download.</p>
      <a href="{{ .Site.Params.appStoreURL }}" class="btn btn-primary">
        <svg width="16" height="16" viewBox="0 0 384 512" fill="currentColor" style="margin-right: 0.5rem;"><path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"/></svg>
        Download on the App Store
      </a>
    </div>
  </div>
</article>
{{ else }}
<!-- Standard page layout -->
<article class="page-content">
  <div class="container">
    <h1>{{ .Title }}</h1>
    {{ .Content }}
  </div>
</article>
{{ end }}
{{ end }}
